<!DOCTYPE html>
<html>
<head>
<title>Admin Dashboard</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<h2>Admin Dashboard</h2>
<div id="pending"></div>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyAhrYtSAdorLMYgBIPeEnXk2nFDG_M65Wc",
 authDomain:"zara-muslim-nikah.firebaseapp.com",
 databaseURL:"https://zara-muslim-nikah-default-rtdb.firebaseio.com",
 projectId:"zara-muslim-nikah"
});

const auth=firebase.auth();
const db=firebase.database();
const adminEmail="ngogrant454@gmail.com";

// Admin login check
auth.onAuthStateChanged(user=>{
 if(!user || user.email!==adminEmail){
   alert("Not admin");
   window.location="index.html";
 } else {
   loadPending();
 }
});

function loadPending(){
 db.ref("users").orderByChild("status").equalTo("pending")
 .on("value",snap=>{
   let html="";
   snap.forEach(child=>{
     const d=child.val();
     html+=`
       <div>
         <img src="${d.photo}" width="100"><br>
         ${d.name}<br>
         <button onclick="approve('${child.key}')">Approve</button>
       </div><hr>
     `;
   });
   document.getElementById("pending").innerHTML=html;
 });
}

// Approve function
function approve(uid){
 const confirmApprove = confirm("Are you sure you want to approve?");
 if(!confirmApprove) return;

 db.ref("users/"+uid).update({status:"approved"})
 .then(()=> alert("Profile approved!"))
 .catch(err => alert("Error: "+err.message));
}
</script>

</body>
</html>
